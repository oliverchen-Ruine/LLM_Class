## Excel文档处理

    Excel文档处理，主要难点在于表格结构复杂，需要智能解析。

### 难点与解析
| 难点 | 特征 | 解决方案 |
|------|------|----------|
| 复杂表格结构 | 数据错位 | pandas智能解析 |
| 公式干扰 | 无实际意义 | 提取计算结果值 |
| 多sheet管理 | 信息分散 | sheet统一处理 |

### Python处理代码
```python
import pandas as pd

def process_excel(excel_path, sheet_name=0):
    """处理Excel文件"""
    df = pd.read_excel(excel_path, sheet_name=sheet_name, skiprows=0, engine="openpyxl")
  
    # 清洗空行空列
    df = df.dropna(axis=0, how="all").dropna(axis=1, how="all")
  
    # 转换为自然语言描述
    text_content = ""
    for idx, row in df.iterrows():
        text_content += f"第{idx+1}行: "
        for col_name, value in row.items():
            text_content += f"{col_name}={value}, "
        text_content += "\n"
  
    return text_content

# 使用示例
excel_path = "code/data.xlsx"
print(process_excel(excel_path))
```

### 文本转换示例
```
第1行: 姓名=张三, 年龄=28, 部门=技术部
第2行: 姓名=李四, 年龄=32, 部门=市场部
```